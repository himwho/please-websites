<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>PLEASE</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <link rel="stylesheet" href="css/styles.css">
        <script src="js/modernizr-2.8.3.min.js"></script>
    </head>
    <body>
        <div class="image-fader" style="">
<!--             <img src="img/please-logo/1.png" class="center-logo"/>
            <img src="img/please-logo/2.png" class="center-logo"/>
            <img src="img/please-logo/3.png" class="center-logo"/>
            <img src="img/please-logo/4.png" class="center-logo"/> -->
            <img src="img/please-logo/5.png" class="center-logo" style="padding-top:10px"/>
            <img src="img/please-logo/6.png" class="center-logo" style="padding-top:10px"/>
            <img src="img/please-logo/7.png" class="center-logo" style="padding-top:10px"/>
            <img src="img/please-logo/8.png" class="center-logo" style="padding-top:10px"/>
<!--             <img src="img/please-logo/9.png" class="center-logo"/>
            <img src="img/please-logo/10.png" class="center-logo"/> -->
        </div>

        <div class="paper productCard" data-name="meatgravy" data-website="meatgravy.club" data-website-url="https://meatgravy.club">
            <img src="img/meatgravy.png">
        </div>
        <div class="paper productCard" data-name="frenchfryangle" data-website="frenchfryangle.com" data-website-url="https://frenchfryangle.com">
            <img src="img/frenchfryangle.png">
        </div>
        <div class="paper productCard" data-name="genesname" data-website="genesname.com" data-website-url="https://genesname.com">
            <img src="img/genesname.png">
        </div>
        <div class="paper productCard" data-name="parallelograndma" data-website="parallelograndma.com" data-website-url="https://parallelograndma.com">
            <img src="img/parallelograndma.png">
        </div>
        <div class="paper productCard" data-name="philorpeter" data-website="philorpeter.com" data-website-url="https://philorpeter.com">
            <img src="img/philorpeter.png">
        </div>
        <div class="paper productCard" data-name="parallelogrammy" data-website="parallelogrammy.com" data-website-url="https://parallelogrammy.com">
            <img src="img/parallelogrammy.png">
        </div>
        <div class="paper productCard" data-name="menacingminstrel" data-website="menacingminstrel.com" data-website-url="https://menacingminstrel.com">
            <img src="img/menacingminstrel.png">
        </div>
        <div class="paper productCard" data-name="mexagons" data-website="mexagons.com" data-website-url="https://mexagons.com">
            <img src="img/mexagons.png">
        </div>
        <div class="paper productCard" data-name="texmexagons" data-website="texmexagons.com" data-website-url="https://texmexagons.com">
            <img src="img/texmexagons.png">
        </div>
        <div class="paper productCard" data-name="praisecod" data-website="praisecod.life" data-website-url="https://praisecod.life">
            <img src="img/praisecod.png">
        </div>        
        <div class="paper productCard" data-name="fuckingsarkis" data-website="fuckingsarkis.com" data-website-url="https://fuckingsarkis.com">
            <img src="img/fuckingsarkis.png">
        </div>
        <div class="paper productCard" data-name="maoxuedong" data-website="maoxuedong.com" data-website-url="https://maoxuedong.com">
            <img src="img/maoxuedong.png">
        </div>
        <div class="paper productCard" data-name="auntcolony" data-website="auntcolony.com" data-website-url="https://auntcolony.com">
            <img src="img/auntcolony.png">
        </div>
        <div class="paper productCard" data-name="plentyofspaghetti" data-website="plentyofspaghetti.com" data-website-url="https://plentyofspaghetti.com">
            <img src="img/plentyofspaghetti.png">
        </div>
        <div class="paper productCard" data-name="notenoughspaghetti" data-website="notenoughspaghetti.com" data-website-url="https://notenoughspaghetti.com">
            <img src="img/notenoughspaghetti.png">
        </div>
        <div class="sign" data-name="city-sign-1" data-email-header='I would like to request a please branded "Do Not Honk We Work Night Shifts" sign!' data-email-url="less_honking@please.nyc">
            <img src="img/city-sign-1.png">
        </div>
        <div class="paper productCard" data-name="antiviral" data-website="antiviral.life" data-website-url="https://antiviral.life">
            <img src="img/antiviral.png">
        </div>
        <!-- 
        <div class="paper productCard" data-name="postit" data-website="tomsachsophone.com" data-website-url="https://tomsachsophone.com">
            <img src="img/postit.png">
        </div>
         -->

        <div class="modal-outer">
            <div id="store-overlay" class="modal-inner">
            </div>
        </div>

        <script>
            const postItElements = document.querySelectorAll('.paper, .sign');
            const productCardButtons = document.querySelectorAll('.productCard');
            const modalOuter = document.querySelector('.modal-outer');
            const modalInner = document.querySelector('.modal-inner');
            productCardButtons.forEach(button => button.addEventListener('click', handleproductCardButtonClick))

            const signButtons = document.querySelectorAll('.sign');
            signButtons.forEach(button => button.addEventListener('click', handleSignButtonClick))

            function handleSignButtonClick(event) {
                const button = event.currentTarget; // Get the clicked button
                const sign = button.closest('.sign'); // Find the closest parent element with the 'sign' class

                // Ensure 'sign' exists
                if (!sign) {
                    console.error("Sign element not found.");
                    return;
                }

                // Get the email URL and body from the data attributes
                const emailTo = sign.dataset.emailUrl;
                const emailSubject = "PLEASE NYC SIGN REQUEST";
                const emailBody = sign.dataset.emailHeader;

                // Construct the mailto link
                const mailtoLink = `mailto:${emailTo}?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;

                // Open the user's email client with the constructed mailto link
                location.href = mailtoLink;
            }

            function handleproductCardButtonClick(event) {
                const button = event.currentTarget;
                const productCard = button.closest('.productCard');
                // Grab the image src
                const imgSrc = productCard.querySelector('img').src;
                const url = productCard.dataset.website;
                const siteURL = productCard.dataset.websiteUrl;
                const name = productCard.dataset.name;
                console.log(siteURL);
                //const name = productCard.querySelector('h2').textContent;

                // populate the modal with the new info
                modalInner.innerHTML = `
                <h2><a href="${siteURL}">${url}</a></h2>
                <iframe src="${siteURL}" title="${siteURL}"></iframe>

                <section class="papers">
                    <div class="paper-static">
                        <img src="img/${name}.png">
                    </div>
                `;

                /* // to be added above
                </section>
                <section class="papers store-overlay-items-row" style="margin-top:-75px;">
                    <div class="paper nozoom" style="margin-left:15px;">
                        <img src="img/Tee1.png">
                    </div>
                    <div class="paper nozoom" style="margin-left:-15px;">
                        <img src="img/Sweater1.png">
                    </div>
                </section>
                <section class="papers store-overlay-buttons-row">
                    <div class="paper nozoom" style="margin-top:-50px;margin-left:15px;">
                        <img src="img/buy1.png" width="imgwidth" height="imgheight" usemap="#seamlessbutton">
                        <map name="seamlessbutton">
                            <area shape="rect" coords="1px,1px,2px,2px" href="link" alt="Seamless Link">
                        </map>
                    </div>
                    <div class="paper nozoom" style="margin-top:-50px;margin-left:-15px;">
                        <img src="img/buy2.png">
                    </div>
                </section>
                */

                // show the modal
                modalOuter.classList.add('open');
            }
            
            function closeModal() {
                modalInner.innerHTML = ``;
                modalOuter.classList.remove('open');
            }

            modalOuter.addEventListener('click', function(event) {
                const isOutside = !event.target.closest('.modal-inner');
                if (isOutside) {
                    closeModal();
                }
            })

            window.addEventListener('keydown', event => {
              //console.log(event);
              if (event.key === 'Escape') {
                closeModal();
              }
            });

            // function that returns a random number between a min and max
            function getRandomNumber(min, max) {
                return Math.random() * (max - min) + min;
            }

            function distance(point1, point2) {
                let y = point2.x - point1.x;
                let x = point2.y - point1.y;
                return Math.sqrt(x * x + y * y);
            }

            function randomizePostIts() {
                var winWidth = window.innerWidth;
                var winHeight = window.innerHeight;
                var centerPointM = { x: winWidth / 2, y: winHeight / 2 };
                // Center thresholds for blocking random points
                var centerPointL = { x: winWidth / 2 - 175, y: winHeight / 2 };
                var centerPointR = { x: winWidth / 2 + 175, y: winHeight / 2 };

                var postItArray = []; // storing array
                postItArray.push(centerPointL, centerPointM, centerPointR); // push back center points

                for (var i = 0; i < postItElements.length; i++) {
                    var thisDiv = postItElements[i];
                    var postItOffsetDistance = thisDiv.offsetWidth; // the minimum amount for a conflict
                    var newPoint; // used to track new testing point
                    var foundConflict = true;
                    var emergencyConflicts = 0; // used to stop tests when too many happen

                    while (foundConflict) {
                        // Generate a random point
                        newPoint = {
                            x: getRandomNumber(0, winWidth - postItOffsetDistance),
                            y: getRandomNumber(0, winHeight - postItOffsetDistance)
                        };

                        var conflicts = 0;

                        for (var j = 0; j < postItArray.length; j++) {
                            var currentDist = distance(newPoint, postItArray[j]);
                            if (currentDist < postItOffsetDistance) {
                                // Too close to another element
                                conflicts++;
                            }
                        }

                        emergencyConflicts++;
                        if (emergencyConflicts > 50) {
                            console.log("Breaking out due to too many conflicts!");
                            foundConflict = false;
                        }

                        if (conflicts === 0) {
                            foundConflict = false;
                            console.log("New Point: X=" + newPoint.x + ", Y=" + newPoint.y);
                        } else {
                            console.log("Conflicts detected, trying new point.");
                        }
                    }

                    // Store the position to prevent overlap
                    postItArray.push(newPoint);

                    // Update element position
                    thisDiv.style.left = newPoint.x + "px";
                    thisDiv.style.top = newPoint.y + "px";
                }
            }

            window.addEventListener("load", function() {
                randomizePostIts();
            });

            window.addEventListener("resize", function(e) {
                randomizePostIts();
            });

        </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/jquery-{{JQUERY_VERSION}}.min.js"><\/script>')</script>
    </body>
</html>